#!/bin/bash
VERSION="v0.1.2"

_script="$(readlink -f ${BASH_SOURCE[0]})"
_base="$(dirname $(dirname $_script))"

if [ "$#" -ne 0 ];
then
  :
else
  printf "Requires args, run blackrose -h\n";
  exit 1;
fi

for arg in $@
do
  case $arg in
    $0) ;;
    '-v' | '--version') printf "[ BlackRose scripting language ]\nVersion: $VERSION \n";;
    '-V' | '--version-number') printf "$VERSION\n";;
    '-i' | '--interactive') $_base/target/release/blackrose ;;
    '-d' | '--documentation' | 'docs') $_base/docs/docs.py $VERSION ;;
    '-u' | '--update' | 'update')
      cd $(dirname $_base)
      rm -rfv $_base
      git clone -b stable --single-branch https://github.com/Alfriadox/BlackRose.git
      cd $_base
      make
      ;;
    '--update-master')
      cd $(dirname $_base)
      rm -rfv $_base
      git clone -b master --single-branch https://github.com/Alfriadox/BlackRose.git
      cd $_base
      make
      ;;
    '-h' | '--help' | '-?' | '--usage') printf """
BlackRose
usage:
  blackrose [args] [file.rose]

Arguments:
  -v, --version                        : Prints version info
  -V, --version-number                 : Prints just version number
  -h, --help, -?, --usage              : Prints this help
  -i, --interactive                    : Run interactively in the terminal
  -d, --documentation, docs            : Opens documentation interface
  -u, --update, update                 : Update Black Rose to stable branch
      --update-master                  : update Black Rose to master (maybe unstable)
    \n""";;
    *)  if [ -f "$arg" ];
        then
          $_base/target/release/blackrose $arg;
        else
          printf "$arg is not a recognized argument.\n" && exit 1;
        fi ;;
  esac
done
